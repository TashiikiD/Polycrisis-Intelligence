<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WSSI Cascade Simulator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #0a0a0f; 
            font-family: 'Segoe UI', system-ui, sans-serif;
            color: white;
        }
        #app {
            display: grid;
            grid-template-columns: 300px 1fr;
            height: 100vh;
        }
        #controls {
            background: rgba(0,0,0,0.5);
            padding: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
            overflow-y: auto;
        }
        #controls h2 {
            font-size: 16px;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .theme-control {
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            border-left: 3px solid #ff8800;
        }
        .theme-control label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 8px;
        }
        .theme-control input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        .current-value {
            font-size: 11px;
            opacity: 0.6;
        }
        #viz-container {
            position: relative;
        }
        #canvas-container {
            width: 100%;
            height: 100%;
        }
        #results {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            min-width: 200px;
        }
        #results .wssi-projection {
            font-size: 48px;
            font-weight: bold;
            color: #ff8800;
        }
        #results .trend {
            font-size: 14px;
            margin: 10px 0;
        }
        .btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
            width: 100%;
        }
        .btn:hover {
            background: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="controls">
            <h2>⚡ Cascade Simulator</h2>
            <p style="font-size: 12px; opacity: 0.7; margin-bottom: 20px;">
                Adjust themes to see projected WSSI impact
            </p>
            <div class="theme-control" style="border-color: #E74C3C">
            <label>
                <span>Sovereign Debt Stress</span>
                <span id="val-1.1">1.0x</span>
            </label>
            <input type="range" id="slider-1.1" min="0.5" max="3" step="0.1" value="1"
                oninput="updateThemeMultiplier('1.1', this.value)">
            <div class="current-value">Current: 0.00</div>
        </div>
<div class="theme-control" style="border-color: #E74C3C">
            <label>
                <span>Corporate Debt Distress</span>
                <span id="val-1.2">1.0x</span>
            </label>
            <input type="range" id="slider-1.2" min="0.5" max="3" step="0.1" value="1"
                oninput="updateThemeMultiplier('1.2', this.value)">
            <div class="current-value">Current: 0.00</div>
        </div>
<div class="theme-control" style="border-color: #E74C3C">
            <label>
                <span>Banking System Stress</span>
                <span id="val-1.3">1.0x</span>
            </label>
            <input type="range" id="slider-1.3" min="0.5" max="3" step="0.1" value="1"
                oninput="updateThemeMultiplier('1.3', this.value)">
            <div class="current-value">Current: 0.00</div>
        </div>
<div class="theme-control" style="border-color: #E74C3C">
            <label>
                <span>Real Asset Bubbles/Busts</span>
                <span id="val-1.4">1.0x</span>
            </label>
            <input type="range" id="slider-1.4" min="0.5" max="3" step="0.1" value="1"
                oninput="updateThemeMultiplier('1.4', this.value)">
            <div class="current-value">Current: 0.00</div>
        </div>
<div class="theme-control" style="border-color: #2ECC71">
            <label>
                <span>Tipping Point Proximity</span>
                <span id="val-2.1">1.0x</span>
            </label>
            <input type="range" id="slider-2.1" min="0.5" max="3" step="0.1" value="1"
                oninput="updateThemeMultiplier('2.1', this.value)">
            <div class="current-value">Current: 0.00</div>
        </div>
<div class="theme-control" style="border-color: #2ECC71">
            <label>
                <span>Extreme Weather Events</span>
                <span id="val-2.2">1.0x</span>
            </label>
            <input type="range" id="slider-2.2" min="0.5" max="3" step="0.1" value="1"
                oninput="updateThemeMultiplier('2.2', this.value)">
            <div class="current-value">Current: 0.00</div>
        </div>
            <button class="btn" onclick="resetSimulation()">Reset</button>
        </div>
        <div id="viz-container">
            <div id="canvas-container"></div>
            <div id="results">
                <div style="font-size: 12px; text-transform: uppercase; opacity: 0.6;">Projected WSSI</div>
                <div class="wssi-projection" id="wssi-value">-1.43</div>
                <div class="trend" id="trend">➡ Deteriorating</div>
                <div style="font-size: 12px; margin-top: 15px;">
                    <div>Themes at risk: <span id="risk-count">0</span></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        const baseData = {"wssi": {"wssi_value": -1.4313, "wssi_score": 14.2175, "stress_level": "approaching", "active_themes": 3, "above_warning": 1, "above_critical": 0, "date": "2026-02-12", "theme_contributions": []}, "nodes": [{"id": "cat_0", "name": "Economic-Financial", "type": "category", "x": 0.40062051461441067, "y": -1.0304006140779935, "z": 1.6666666666666667, "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "1.1", "name": "Sovereign Debt Stress", "type": "theme", "category": "Economic-Financial", "x": 1.2006205146144107, "y": -1.0304006140779935, "z": 1.6666666666666667, "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "1.2", "name": "Corporate Debt Distress", "type": "theme", "category": "Economic-Financial", "x": 0.4006205146144107, "y": -0.2304006140779935, "z": 1.6666666666666667, "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "1.3", "name": "Banking System Stress", "type": "theme", "category": "Economic-Financial", "x": -0.3993794853855894, "y": -1.0304006140779935, "z": 1.6666666666666667, "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "1.4", "name": "Real Asset Bubbles/Busts", "type": "theme", "category": "Economic-Financial", "x": 0.4006205146144105, "y": -1.8304006140779936, "z": 1.6666666666666667, "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "cat_1", "name": "Climate-Environmental", "type": "category", "x": -1.553273411691674, "y": 0.766382220913108, "z": 0.9999999999999998, "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "2.1", "name": "Tipping Point Proximity", "type": "theme", "category": "Climate-Environmental", "x": -0.7532734116916739, "y": 0.766382220913108, "z": 0.9999999999999998, "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "2.2", "name": "Extreme Weather Events", "type": "theme", "category": "Climate-Environmental", "x": -1.553273411691674, "y": 1.5663822209131082, "z": 0.9999999999999998, "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "2.3", "name": "Carbon Cycle Disruption", "type": "theme", "category": "Climate-Environmental", "x": -2.3532734116916743, "y": 0.7663822209131081, "z": 0.9999999999999998, "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "2.4", "name": "Ecosystem Collapse", "type": "theme", "category": "Climate-Environmental", "x": -1.5532734116916742, "y": -0.03361777908689201, "z": 0.9999999999999998, "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "cat_2", "name": "Geopolitical-Conflict", "type": "category", "x": 1.8934306799861993, "y": 0.5511888505547695, "z": 0.33333333333333337, "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "3.1", "name": "Interstate Conflict", "type": "theme", "category": "Geopolitical-Conflict", "x": 2.693430679986199, "y": 0.5511888505547695, "z": 0.33333333333333337, "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "3.4", "name": "Governance Decay", "type": "theme", "category": "Geopolitical-Conflict", "x": 1.8934306799861993, "y": 1.3511888505547696, "z": 0.33333333333333337, "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "3.2", "name": "Intrastate Violence", "type": "theme", "category": "Geopolitical-Conflict", "x": 1.0934306799861992, "y": 0.5511888505547696, "z": 0.33333333333333337, "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "3.3", "name": "Resource Competition", "type": "theme", "category": "Geopolitical-Conflict", "x": 1.893430679986199, "y": -0.24881114944523053, "z": 0.33333333333333337, "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "cat_3", "name": "Technological", "type": "category", "x": -1.0238341373655802, "y": -1.685423551530525, "z": -0.3333333333333336, "value": 0.0, "stress_level": "stable", "color": "#3498DB"}, {"id": "4.2", "name": "Cyber Systemic Risk", "type": "theme", "category": "Technological", "x": -0.2238341373655801, "y": -1.685423551530525, "z": -0.3333333333333336, "value": 0.0, "stress_level": "stable", "color": "#3498DB"}, {"id": "4.1", "name": "Critical Infra Failure", "type": "theme", "category": "Technological", "x": -1.42383413736558, "y": -0.9926032285029739, "z": -0.3333333333333336, "value": 0.0, "stress_level": "stable", "color": "#3498DB"}, {"id": "4.3", "name": "AI/Compute Concentration", "type": "theme", "category": "Technological", "x": -1.4238341373655805, "y": -2.3782438745580756, "z": -0.3333333333333336, "value": 0.0, "stress_level": "stable", "color": "#3498DB"}, {"id": "cat_4", "name": "Biological-Health", "type": "category", "x": -0.33687039910518446, "y": 1.6989756720467524, "z": -1.0000000000000004, "value": 0.0, "stress_level": "stable", "color": "#9B59B6"}, {"id": "5.1", "name": "Pandemic/Pathogen Risk", "type": "theme", "category": "Biological-Health", "x": 0.4631296008948156, "y": 1.6989756720467524, "z": -1.0000000000000004, "value": 0.0, "stress_level": "stable", "color": "#9B59B6"}, {"id": "5.2", "name": "Food System Fragility", "type": "theme", "category": "Biological-Health", "x": -1.1368703991051845, "y": 1.6989756720467524, "z": -1.0000000000000004, "value": 0.0, "stress_level": "stable", "color": "#9B59B6"}, {"id": "cat_5", "name": "Cross-Cutting", "type": "category", "x": 0.891070595435421, "y": -0.6543817052551112, "z": -1.6666666666666665, "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}, {"id": "6.1", "name": "Cascade Interactions", "type": "theme", "category": "Cross-Cutting", "x": 1.691070595435421, "y": -0.6543817052551112, "z": -1.6666666666666665, "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}, {"id": "6.2", "name": "Correlation Clusters", "type": "theme", "category": "Cross-Cutting", "x": 0.49107059543542114, "y": 0.03843861777243984, "z": -1.6666666666666665, "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}, {"id": "6.3", "name": "Systemic Resilience", "type": "theme", "category": "Cross-Cutting", "x": 0.49107059543542064, "y": -1.3472020282826618, "z": -1.6666666666666665, "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}], "categories": ["Economic-Financial", "Climate-Environmental", "Geopolitical-Conflict", "Technological", "Biological-Health", "Cross-Cutting"], "metadata": {"generated_at": "2026-02-12T19:35:41.474462"}};
        let currentMultipliers = {};
        
        // Initialize multipliers
        baseData.nodes.filter(n => n.type === 'theme').forEach(node => {
            currentMultipliers[node.id] = 1.0;
        });
        
        // Scene setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 8;
        camera.position.y = 2;
        camera.lookAt(0, 0, 0);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        const container = document.getElementById('canvas-container');
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);
        
        // Lighting
        const ambientLight = new THREE.AmbientLight(0x404040, 2);
        scene.add(ambientLight);
        
        const pointLight = new THREE.PointLight(0xffffff, 1, 100);
        pointLight.position.set(10, 10, 10);
        scene.add(pointLight);
        
        const pointLight2 = new THREE.PointLight(#ff8800, 2, 50);
        pointLight2.position.set(-5, -5, 5);
        scene.add(pointLight2);
        
        // Core Orb
        const coreGeometry = new THREE.SphereGeometry(0.8, 64, 64);
        const coreMaterial = new THREE.MeshPhongMaterial({
            color: #ff8800,
            emissive: #ff8800,
            emissiveIntensity: 0.5,
            shininess: 100,
            transparent: true,
            opacity: 0.9
        });
        const coreOrb = new THREE.Mesh(coreGeometry, coreMaterial);
        scene.add(coreOrb);
        
        // Glow
        const glowGeometry = new THREE.SphereGeometry(1.2, 32, 32);
        const glowMaterial = new THREE.MeshBasicMaterial({
            color: #ff8800,
            transparent: true,
            opacity: 0.1
        });
        const coreGlow = new THREE.Mesh(glowGeometry, glowMaterial);
        scene.add(coreGlow);
        
        // Theme nodes with interactivity
        const nodeMeshes = {};
        const basePositions = {};
        
        baseData.nodes.forEach(node => {
            if (node.type === 'theme') {
                const size = 0.1 + (node.value * 0.15);
                const geometry = new THREE.SphereGeometry(size, 16, 16);
                const material = new THREE.MeshPhongMaterial({
                    color: node.color,
                    emissive: node.color,
                    emissiveIntensity: 0.3,
                    shininess: 50
                });
                
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.set(node.x, node.y, node.z);
                mesh.userData = node;
                scene.add(mesh);
                
                nodeMeshes[node.id] = mesh;
                basePositions[node.id] = { x: node.x, y: node.y, z: node.z };
                
                // Connection line
                const lineGeometry = new THREE.BufferGeometry().setFromPoints([
                    new THREE.Vector3(0, 0, 0),
                    new THREE.Vector3(node.x, node.y, node.z)
                ]);
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: node.color,
                    transparent: true,
                    opacity: 0.2
                });
                const line = new THREE.Line(lineGeometry, lineMaterial);
                scene.add(line);
            }
        });
        
        // Update simulation
        function updateSimulation() {
            let totalStress = 0;
            let atRisk = 0;
            
            Object.keys(nodeMeshes).forEach(id => {
                const mesh = nodeMeshes[id];
                const basePos = basePositions[id];
                const multiplier = currentMultipliers[id] || 1.0;
                const baseValue = mesh.userData.value;
                
                // Expand outward based on multiplier
                const expansion = 1 + (multiplier - 1) * 0.5;
                mesh.position.x = basePos.x * expansion;
                mesh.position.y = basePos.y * expansion;
                mesh.position.z = basePos.z * expansion;
                
                // Scale based on stress
                const newValue = baseValue * multiplier;
                const scale = 1 + (newValue - baseValue) * 0.5;
                mesh.scale.set(scale, scale, scale);
                
                // Update material
                if (newValue > 0.7) {
                    mesh.material.emissiveIntensity = 0.6;
                    atRisk++;
                } else {
                    mesh.material.emissiveIntensity = 0.3;
                }
                
                totalStress += newValue;
            });
            
            // Calculate projected WSSI
            const baseWSSI = -1.4313;
            const projectedWSSI = baseWSSI - (totalStress * 0.1);
            
            // Update UI
            document.getElementById('wssi-value').textContent = projectedWSSI.toFixed(2);
            document.getElementById('risk-count').textContent = atRisk;
            
            // Update trend
            const delta = projectedWSSI - baseWSSI;
            const trendEl = document.getElementById('trend');
            if (delta < -0.5) {
                trendEl.textContent = '⬆ Accelerating';
                trendEl.style.color = '#ff0040';
            } else if (delta < -0.2) {
                trendEl.textContent = '➡ Deteriorating';
                trendEl.style.color = '#ff8800';
            } else {
                trendEl.textContent = '➡ Stable';
                trendEl.style.color = '#00ffcc';
            }
            
            // Update core color
            let newColor;
            if (projectedWSSI < -1.5) newColor = 0xff0040;
            else if (projectedWSSI < -1.0) newColor = 0xff8800;
            else if (projectedWSSI < -0.5) newColor = 0xffcc00;
            else newColor = 0x00ffcc;
            
            coreMaterial.color.setHex(newColor);
            coreMaterial.emissive.setHex(newColor);
            glowMaterial.color.setHex(newColor);
        }
        
        // Slider handlers
        <script>
        function updateThemeMultiplier(id, value) {
            currentMultipliers[id] = parseFloat(value);
            document.getElementById('val-' + id).textContent = parseFloat(value).toFixed(1) + 'x';
            updateSimulation();
        }
        </script>
        
        function resetSimulation() {
            Object.keys(currentMultipliers).forEach(id => {
                currentMultipliers[id] = 1.0;
                const slider = document.getElementById('slider-' + id);
                if (slider) slider.value = 1.0;
                const label = document.getElementById('val-' + id);
                if (label) label.textContent = '1.0x';
            });
            updateSimulation();
        }
        
        // Animation
        let time = 0;
        function animate() {
            requestAnimationFrame(animate);
            time += 0.01;
            
            const pulse = 1 + Math.sin(time * 2) * 0.1;
            coreOrb.scale.set(pulse, pulse, pulse);
            coreGlow.scale.set(pulse * 1.2, pulse * 1.2, pulse * 1.2);
            
            coreOrb.rotation.y += 0.002;
            
            renderer.render(scene, camera);
        }
        
        window.addEventListener('resize', () => {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });
        
        animate();
    </script>
</body>
</html>
