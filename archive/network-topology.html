<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WSSI Crisis Correlation Network</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #0a0a0f; 
            font-family: 'Segoe UI', system-ui, sans-serif;
            overflow: hidden;
        }
        #graph-container { width: 100vw; height: 100vh; }
        
        .node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .node:hover {
            filter: brightness(1.3);
        }
        .node circle {
            stroke: #fff;
            stroke-width: 1.5px;
        }
        .node text {
            fill: #fff;
            font-size: 11px;
            pointer-events: none;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
        }
        
        .link {
            stroke-opacity: 0.6;
            transition: stroke-width 0.3s ease;
        }
        .link:hover {
            stroke-opacity: 1;
        }
        
        #overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            max-width: 300px;
        }
        #overlay h1 { font-size: 20px; margin-bottom: 10px; }
        #overlay .stats { 
            font-size: 12px; 
            opacity: 0.7;
            margin-top: 10px;
        }
        
        #tooltip {
            position: absolute;
            padding: 12px;
            background: rgba(0,0,0,0.9);
            color: white;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            border: 1px solid rgba(255,255,255,0.1);
            font-size: 13px;
            max-width: 250px;
        }
        #tooltip.visible { opacity: 1; }
        
        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
        }
        .control-btn {
            background: rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        .control-btn:hover {
            background: rgba(255,255,255,0.1);
        }
        
        #legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 8px;
            color: white;
        }
        .legend-item { 
            display: flex; 
            align-items: center; 
            margin: 5px 0;
            font-size: 12px;
        }
        .legend-color { 
            width: 12px; 
            height: 12px; 
            border-radius: 50%; 
            margin-right: 8px;
        }
        
        .flash-banner {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff0040, #ff8800);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 13px;
            max-width: 350px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .flash-banner h3 {
            margin-bottom: 5px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="graph-container"></div>
    
    <div id="overlay">
        <h1>üîó Crisis Correlation Network</h1>
        <p>Visualizing interconnections between polycrisis themes</p>
        <div class="stats">
            Nodes: 20 | Links: 190<br>
            Min correlation: 0.3
        </div>
    </div>
    
    
        <div class="flash-banner">
            <h3>‚ö° Flash Point Detected</h3>
            <p>Sovereign Debt Stress + Corporate Debt Distress correlation spike</p>
            <p>Correlation: 0.95</p>
        </div>
        
    
    <div id="tooltip"></div>
    
    <div id="controls">
        <button class="control-btn" onclick="resetZoom()">‚ü≤ Reset View</button>
        <button class="control-btn" onclick="toggleLabels()">üè∑Ô∏è Toggle Labels</button>
        <button class="control-btn" onclick="isolateHighStress()">üö® High Stress Only</button>
    </div>
    
    <div id="legend">
        <h3>Categories</h3>
        <div class="legend-item"><div class="legend-color" style="background: #E74C3C"></div>Economic-Financial</div>
<div class="legend-item"><div class="legend-color" style="background: #2ECC71"></div>Climate-Environmental</div>
<div class="legend-item"><div class="legend-color" style="background: #F39C12"></div>Geopolitical-Conflict</div>
<div class="legend-item"><div class="legend-color" style="background: #3498DB"></div>Technological</div>
<div class="legend-item"><div class="legend-color" style="background: #9B59B6"></div>Biological-Health</div>
<div class="legend-item"><div class="legend-color" style="background: #95A5A6"></div>Cross-Cutting</div>
        <h3 style="margin-top: 15px;">Link Types</h3>
        <div class="legend-item">
            <svg width="30" height="4" style="margin-right: 8px;">
                <line x1="0" y1="2" x2="30" y2="2" stroke="#ff6b6b" stroke-width="2"/>
            </svg>
            Intra-system (same category)
        </div>
        <div class="legend-item">
            <svg width="30" height="4" style="margin-right: 8px;">
                <line x1="0" y1="2" x2="30" y2="2" stroke="#4ecdc4" stroke-width="2" stroke-dasharray="5,3"/>
            </svg>
            Cross-domain
        </div>
    </div>

    <script>
        const networkData = {"nodes": [{"id": "1.1", "name": "Sovereign Debt Stress", "category": "Economic-Financial", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "1.2", "name": "Corporate Debt Distress", "category": "Economic-Financial", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "1.3", "name": "Banking System Stress", "category": "Economic-Financial", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "2.1", "name": "Tipping Point Proximity", "category": "Climate-Environmental", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "2.2", "name": "Extreme Weather Events", "category": "Climate-Environmental", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "3.1", "name": "Interstate Conflict", "category": "Geopolitical-Conflict", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "3.4", "name": "Governance Decay", "category": "Geopolitical-Conflict", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "4.2", "name": "Cyber Systemic Risk", "category": "Technological", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#3498DB"}, {"id": "5.1", "name": "Pandemic/Pathogen Risk", "category": "Biological-Health", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#9B59B6"}, {"id": "5.2", "name": "Food System Fragility", "category": "Biological-Health", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#9B59B6"}, {"id": "6.1", "name": "Cascade Interactions", "category": "Cross-Cutting", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}, {"id": "6.2", "name": "Correlation Clusters", "category": "Cross-Cutting", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}, {"id": "6.3", "name": "Systemic Resilience", "category": "Cross-Cutting", "priority": "P0", "value": 0.0, "stress_level": "stable", "color": "#95A5A6"}, {"id": "1.4", "name": "Real Asset Bubbles/Busts", "category": "Economic-Financial", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#E74C3C"}, {"id": "2.3", "name": "Carbon Cycle Disruption", "category": "Climate-Environmental", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "2.4", "name": "Ecosystem Collapse", "category": "Climate-Environmental", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#2ECC71"}, {"id": "3.2", "name": "Intrastate Violence", "category": "Geopolitical-Conflict", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "3.3", "name": "Resource Competition", "category": "Geopolitical-Conflict", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#F39C12"}, {"id": "4.1", "name": "Critical Infra Failure", "category": "Technological", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#3498DB"}, {"id": "4.3", "name": "AI/Compute Concentration", "category": "Technological", "priority": "P1", "value": 0.0, "stress_level": "stable", "color": "#3498DB"}], "links": [{"source": "1.1", "target": "1.2", "value": 0.95, "type": "intra_system"}, {"source": "1.1", "target": "1.3", "value": 0.95, "type": "intra_system"}, {"source": "1.1", "target": "2.1", "value": 0.6, "type": "climate_economic"}, {"source": "1.1", "target": "2.2", "value": 0.6, "type": "climate_economic"}, {"source": "1.1", "target": "3.1", "value": 0.6, "type": "conflict_economic"}, {"source": "1.1", "target": "3.4", "value": 0.6, "type": "conflict_economic"}, {"source": "1.1", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.1", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "1.1", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.1", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "1.1", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.1", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "1.1", "target": "1.4", "value": 0.8, "type": "intra_system"}, {"source": "1.1", "target": "2.3", "value": 0.4, "type": "climate_economic"}, {"source": "1.1", "target": "2.4", "value": 0.4, "type": "climate_economic"}, {"source": "1.1", "target": "3.2", "value": 0.4, "type": "conflict_economic"}, {"source": "1.1", "target": "3.3", "value": 0.4, "type": "conflict_economic"}, {"source": "1.1", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "1.1", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "1.2", "target": "1.3", "value": 0.95, "type": "intra_system"}, {"source": "1.2", "target": "2.1", "value": 0.6, "type": "climate_economic"}, {"source": "1.2", "target": "2.2", "value": 0.6, "type": "climate_economic"}, {"source": "1.2", "target": "3.1", "value": 0.6, "type": "conflict_economic"}, {"source": "1.2", "target": "3.4", "value": 0.6, "type": "conflict_economic"}, {"source": "1.2", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.2", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "1.2", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.2", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "1.2", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.2", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "1.2", "target": "1.4", "value": 0.8, "type": "intra_system"}, {"source": "1.2", "target": "2.3", "value": 0.4, "type": "climate_economic"}, {"source": "1.2", "target": "2.4", "value": 0.4, "type": "climate_economic"}, {"source": "1.2", "target": "3.2", "value": 0.4, "type": "conflict_economic"}, {"source": "1.2", "target": "3.3", "value": 0.4, "type": "conflict_economic"}, {"source": "1.2", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "1.2", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "1.3", "target": "2.1", "value": 0.6, "type": "climate_economic"}, {"source": "1.3", "target": "2.2", "value": 0.6, "type": "climate_economic"}, {"source": "1.3", "target": "3.1", "value": 0.6, "type": "conflict_economic"}, {"source": "1.3", "target": "3.4", "value": 0.6, "type": "conflict_economic"}, {"source": "1.3", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.3", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "1.3", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.3", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "1.3", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "1.3", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "1.3", "target": "1.4", "value": 0.8, "type": "intra_system"}, {"source": "1.3", "target": "2.3", "value": 0.4, "type": "climate_economic"}, {"source": "1.3", "target": "2.4", "value": 0.4, "type": "climate_economic"}, {"source": "1.3", "target": "3.2", "value": 0.4, "type": "conflict_economic"}, {"source": "1.3", "target": "3.3", "value": 0.4, "type": "conflict_economic"}, {"source": "1.3", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "1.3", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "2.1", "target": "2.2", "value": 0.95, "type": "intra_system"}, {"source": "2.1", "target": "3.1", "value": 0.6, "type": "climate_conflict"}, {"source": "2.1", "target": "3.4", "value": 0.6, "type": "climate_conflict"}, {"source": "2.1", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "2.1", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "2.1", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "2.1", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "2.1", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "2.1", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "2.1", "target": "1.4", "value": 0.4, "type": "climate_economic"}, {"source": "2.1", "target": "2.3", "value": 0.8, "type": "intra_system"}, {"source": "2.1", "target": "2.4", "value": 0.8, "type": "intra_system"}, {"source": "2.1", "target": "3.2", "value": 0.4, "type": "climate_conflict"}, {"source": "2.1", "target": "3.3", "value": 0.4, "type": "climate_conflict"}, {"source": "2.1", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "2.1", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "2.2", "target": "3.1", "value": 0.6, "type": "climate_conflict"}, {"source": "2.2", "target": "3.4", "value": 0.6, "type": "climate_conflict"}, {"source": "2.2", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "2.2", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "2.2", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "2.2", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "2.2", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "2.2", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "2.2", "target": "1.4", "value": 0.4, "type": "climate_economic"}, {"source": "2.2", "target": "2.3", "value": 0.8, "type": "intra_system"}, {"source": "2.2", "target": "2.4", "value": 0.8, "type": "intra_system"}, {"source": "2.2", "target": "3.2", "value": 0.4, "type": "climate_conflict"}, {"source": "2.2", "target": "3.3", "value": 0.4, "type": "climate_conflict"}, {"source": "2.2", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "2.2", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "3.1", "target": "3.4", "value": 0.95, "type": "intra_system"}, {"source": "3.1", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "3.1", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "3.1", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "3.1", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "3.1", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "3.1", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "3.1", "target": "1.4", "value": 0.4, "type": "conflict_economic"}, {"source": "3.1", "target": "2.3", "value": 0.4, "type": "climate_conflict"}, {"source": "3.1", "target": "2.4", "value": 0.4, "type": "climate_conflict"}, {"source": "3.1", "target": "3.2", "value": 0.8, "type": "intra_system"}, {"source": "3.1", "target": "3.3", "value": 0.8, "type": "intra_system"}, {"source": "3.1", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "3.1", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "3.4", "target": "4.2", "value": 0.6, "type": "cross_domain"}, {"source": "3.4", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "3.4", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "3.4", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "3.4", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "3.4", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "3.4", "target": "1.4", "value": 0.4, "type": "conflict_economic"}, {"source": "3.4", "target": "2.3", "value": 0.4, "type": "climate_conflict"}, {"source": "3.4", "target": "2.4", "value": 0.4, "type": "climate_conflict"}, {"source": "3.4", "target": "3.2", "value": 0.8, "type": "intra_system"}, {"source": "3.4", "target": "3.3", "value": 0.8, "type": "intra_system"}, {"source": "3.4", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "3.4", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "4.2", "target": "5.1", "value": 0.6, "type": "cross_domain"}, {"source": "4.2", "target": "5.2", "value": 0.6, "type": "cross_domain"}, {"source": "4.2", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "4.2", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "4.2", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "4.2", "target": "1.4", "value": 0.4, "type": "cross_domain"}, {"source": "4.2", "target": "2.3", "value": 0.4, "type": "cross_domain"}, {"source": "4.2", "target": "2.4", "value": 0.4, "type": "cross_domain"}, {"source": "4.2", "target": "3.2", "value": 0.4, "type": "cross_domain"}, {"source": "4.2", "target": "3.3", "value": 0.4, "type": "cross_domain"}, {"source": "4.2", "target": "4.1", "value": 0.8, "type": "intra_system"}, {"source": "4.2", "target": "4.3", "value": 0.8, "type": "intra_system"}, {"source": "5.1", "target": "5.2", "value": 0.95, "type": "intra_system"}, {"source": "5.1", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "5.1", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "5.1", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "5.1", "target": "1.4", "value": 0.4, "type": "cross_domain"}, {"source": "5.1", "target": "2.3", "value": 0.4, "type": "cross_domain"}, {"source": "5.1", "target": "2.4", "value": 0.4, "type": "cross_domain"}, {"source": "5.1", "target": "3.2", "value": 0.4, "type": "cross_domain"}, {"source": "5.1", "target": "3.3", "value": 0.4, "type": "cross_domain"}, {"source": "5.1", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "5.1", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "6.1", "value": 0.6, "type": "cross_domain"}, {"source": "5.2", "target": "6.2", "value": 0.6, "type": "cross_domain"}, {"source": "5.2", "target": "6.3", "value": 0.6, "type": "cross_domain"}, {"source": "5.2", "target": "1.4", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "2.3", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "2.4", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "3.2", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "3.3", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "5.2", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "6.2", "value": 0.95, "type": "intra_system"}, {"source": "6.1", "target": "6.3", "value": 0.95, "type": "intra_system"}, {"source": "6.1", "target": "1.4", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "2.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "2.4", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "3.2", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "3.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "6.1", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "6.3", "value": 0.95, "type": "intra_system"}, {"source": "6.2", "target": "1.4", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "2.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "2.4", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "3.2", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "3.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "6.2", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "1.4", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "2.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "2.4", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "3.2", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "3.3", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "6.3", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "1.4", "target": "2.3", "value": 0.4, "type": "climate_economic"}, {"source": "1.4", "target": "2.4", "value": 0.4, "type": "climate_economic"}, {"source": "1.4", "target": "3.2", "value": 0.4, "type": "conflict_economic"}, {"source": "1.4", "target": "3.3", "value": 0.4, "type": "conflict_economic"}, {"source": "1.4", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "1.4", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "2.3", "target": "2.4", "value": 0.8, "type": "intra_system"}, {"source": "2.3", "target": "3.2", "value": 0.4, "type": "climate_conflict"}, {"source": "2.3", "target": "3.3", "value": 0.4, "type": "climate_conflict"}, {"source": "2.3", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "2.3", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "2.4", "target": "3.2", "value": 0.4, "type": "climate_conflict"}, {"source": "2.4", "target": "3.3", "value": 0.4, "type": "climate_conflict"}, {"source": "2.4", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "2.4", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "3.2", "target": "3.3", "value": 0.8, "type": "intra_system"}, {"source": "3.2", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "3.2", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "3.3", "target": "4.1", "value": 0.4, "type": "cross_domain"}, {"source": "3.3", "target": "4.3", "value": 0.4, "type": "cross_domain"}, {"source": "4.1", "target": "4.3", "value": 0.8, "type": "intra_system"}], "metadata": {"node_count": 20, "link_count": 190, "generated_at": "2026-02-12T19:33:32.610214"}};
        
        const width = window.innerWidth;
        const height = window.innerHeight;
        
        // Category color mapping
        const categoryColors = {"Economic-Financial": "#E74C3C", "Climate-Environmental": "#2ECC71", "Geopolitical-Conflict": "#F39C12", "Technological": "#3498DB", "Biological-Health": "#9B59B6", "Cross-Cutting": "#95A5A6"};
        
        // Create SVG
        const svg = d3.select("#graph-container")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .call(d3.zoom().on("zoom", (event) => {
                g.attr("transform", event.transform);
            }));
        
        const g = svg.append("g");
        
        // Arrow markers for directed graph (optional)
        svg.append("defs").selectAll("marker")
            .data(["end"])
            .enter().append("marker")
            .attr("id", String)
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 25)
            .attr("refY", 0)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M0,-5L10,0L0,5")
            .attr("fill", "#666");
        
        // Force simulation
        const simulation = d3.forceSimulation(networkData.nodes)
            .force("link", d3.forceLink(networkData.links)
                .id(d => d.id)
                .distance(d => 100 + (1 - d.value) * 100))
            .force("charge", d3.forceManyBody().strength(-300))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(d => 20 + d.value * 20));
        
        // Create links
        const link = g.append("g")
            .attr("class", "links")
            .selectAll("line")
            .data(networkData.links)
            .enter().append("line")
            .attr("class", "link")
            .attr("stroke", d => {
                if (d.type === 'intra_system') return '#ff6b6b';
                return '#4ecdc4';
            })
            .attr("stroke-width", d => Math.sqrt(d.value) * 4)
            .attr("stroke-dasharray", d => d.type === 'intra_system' ? null : "5,3");
        
        // Create nodes
        const node = g.append("g")
            .attr("class", "nodes")
            .selectAll("g")
            .data(networkData.nodes)
            .enter().append("g")
            .attr("class", "node")
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));
        
        // Node circles
        node.append("circle")
            .attr("r", d => 8 + d.value * 12)
            .attr("fill", d => categoryColors[d.category] || '#666')
            .attr("stroke", d => {
                if (d.stress_level === 'critical') return '#ff0040';
                if (d.stress_level === 'approaching') return '#ff8800';
                return '#fff';
            })
            .attr("stroke-width", d => d.stress_level === 'critical' ? 3 : 1.5);
        
        // Node labels (initially visible for larger nodes)
        const labels = node.append("text")
            .attr("dx", d => 12 + d.value * 5)
            .attr("dy", ".35em")
            .text(d => d.name)
            .style("opacity", d => d.value > 0.5 ? 1 : 0.7);
        
        // Tooltip
        const tooltip = d3.select("#tooltip");
        
        node.on("mouseover", function(event, d) {
            d3.select(this).select("circle")
                .transition()
                .duration(200)
                .attr("r", (d.value * 12 + 8) * 1.3);
            
            tooltip.html(`
                <strong>${d.name}</strong><br/>
                Category: ${d.category}<br/>
                Stress: ${d.stress_level}<br/>
                Signal: ${d.value.toFixed(2)}<br/>
                Priority: ${d.priority}
            `)
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 10) + "px")
            .classed("visible", true);
        })
        .on("mouseout", function(event, d) {
            d3.select(this).select("circle")
                .transition()
                .duration(200)
                .attr("r", d.value * 12 + 8);
            
            tooltip.classed("visible", false);
        })
        .on("click", function(event, d) {
            // Highlight connected nodes
            const connected = new Set();
            connected.add(d.id);
            
            networkData.links.forEach(l => {
                if (l.source.id === d.id) connected.add(l.target.id);
                if (l.target.id === d.id) connected.add(l.source.id);
            });
            
            node.style("opacity", n => connected.has(n.id) ? 1 : 0.2);
            link.style("opacity", l => 
                (l.source.id === d.id || l.target.id === d.id) ? 1 : 0.05
            );
        });
        
        // Double-click to reset
        svg.on("dblclick", () => {
            node.style("opacity", 1);
            link.style("opacity", 0.6);
        });
        
        // Update positions on tick
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);
            
            node
                .attr("transform", d => `translate(${d.x},${d.y})`);
        });
        
        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }
        
        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }
        
        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }
        
        // Control functions
        let labelsVisible = true;
        
        function resetZoom() {
            svg.transition().duration(750).call(
                d3.zoom().transform,
                d3.zoomIdentity
            );
            node.style("opacity", 1);
            link.style("opacity", 0.6);
        }
        
        function toggleLabels() {
            labelsVisible = !labelsVisible;
            labels.transition().duration(300).style("opacity", labelsVisible ? 1 : 0);
        }
        
        function isolateHighStress() {
            const highStress = new Set();
            networkData.nodes.forEach(n => {
                if (n.stress_level === 'critical' || n.stress_level === 'approaching') {
                    highStress.add(n.id);
                }
            });
            
            node.transition().duration(300)
                .style("opacity", n => highStress.has(n.id) ? 1 : 0.1);
            
            link.transition().duration(300)
                .style("opacity", l => 
                    (highStress.has(l.source.id) && highStress.has(l.target.id)) ? 0.8 : 0.05
                );
        }
        
        // Resize handler
        window.addEventListener('resize', () => {
            const newWidth = window.innerWidth;
            const newHeight = window.innerHeight;
            svg.attr("width", newWidth).attr("height", newHeight);
            simulation.force("center", d3.forceCenter(newWidth / 2, newHeight / 2));
            simulation.alpha(0.3).restart();
        });
    </script>
</body>
</html>
